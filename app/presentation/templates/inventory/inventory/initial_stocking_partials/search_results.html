{% if error %}
<div class="alert alert-danger">
    <i class="bi bi-exclamation-triangle"></i> Error: {{ error }}
</div>
{% elif not storeroom_id %}
<div class="alert alert-info">
    <i class="bi bi-info-circle"></i> Please select a storeroom to search for unassigned inventory.
</div>
{% elif search_results %}
<div class="list-group">
    {% for inv in search_results %}
    <div class="list-group-item">
        <div class="row align-items-center">
            <div class="col-md-8">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        {% if inv.part %}
                        <h6 class="mb-1"><strong>{{ inv.part.part_number }}</strong></h6>
                        <p class="mb-1 text-muted">{{ inv.part.part_name }}</p>
                        {% else %}
                        <h6 class="mb-1"><strong>Part #{{ inv.part_id }}</strong></h6>
                        {% endif %}
                        <small class="text-muted">
                            <i class="bi bi-building"></i> 
                            {% if inv.storeroom %}
                                {{ inv.storeroom.room_name }}
                                {% if inv.storeroom.major_location %}
                                    ({{ inv.storeroom.major_location.name }})
                                {% endif %}
                            {% else %}
                                N/A
                            {% endif %}
                        </small>
                    </div>
                </div>
            </div>
            <div class="col-md-4 text-end">
                <div class="mb-2">
                    <span class="badge bg-secondary">
                        <i class="bi bi-box-seam"></i> Available: {{ '%.2f'|format(inv.quantity_on_hand - inv.quantity_allocated) }}
                    </span>
                    {% if inv.unit_cost_avg %}
                    <span class="badge bg-info">
                        <i class="bi bi-currency-dollar"></i> ${{ '%.2f'|format(inv.unit_cost_avg) }}
                    </span>
                    {% endif %}
                </div>
                <button type="button" 
                        class="btn btn-sm btn-success add-to-queue-btn"
                        data-inventory-id="{{ inv.id }}"
                        data-part-number="{% if inv.part %}{{ inv.part.part_number }}{% else %}Part #{{ inv.part_id }}{% endif %}"
                        data-part-name="{% if inv.part %}{{ inv.part.part_name }}{% endif %}"
                        data-available-qty="{{ inv.quantity_on_hand - inv.quantity_allocated }}"
                        data-storeroom-id="{{ inv.storeroom_id }}"
                        data-storeroom-name="{% if inv.storeroom %}{{ inv.storeroom.room_name }}{% endif %}"
                        data-part-id="{{ inv.part_id }}"
                        onclick="handleAddToQueue(this)">
                    <i class="bi bi-plus-circle"></i> Add to Queue
                </button>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
<div class="text-muted small mt-2">
    <i class="bi bi-info-circle"></i> Showing {{ search_results|length }} result{{ 's' if search_results|length != 1 else '' }}{% if search_results|length == 50 %} (limited to 50){% endif %}
</div>
{% else %}
<div class="alert alert-info">
    <i class="bi bi-inbox"></i> No unassigned inventory found{% if part_search %} for "{{ part_search }}"{% endif %}.
</div>
{% endif %}

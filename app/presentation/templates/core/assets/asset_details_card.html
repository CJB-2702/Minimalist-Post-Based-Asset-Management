{% if asset %}
    <div class="row">
        <div class="col-md-8">
            <!-- Asset Information -->
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="bi bi-gear"></i> Asset Information
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <table class="table table-sm table-borderless">
                                <tr>
                                    <th width="40%">Asset ID:</th>
                                    <td><code>{{ asset.id }}</code></td>
                                </tr>
                                <tr>
                                    <th>Name:</th>
                                    <td><strong>{{ asset.name }}</strong></td>
                                </tr>
                                <tr>
                                    <th>Serial Number:</th>
                                    <td><code>{{ asset.serial_number }}</code></td>
                                </tr>
                                <tr>
                                    <th>Status:</th>
                                    <td>
                                        {% if asset.status == 'Active' %}
                                            <span class="badge bg-success">Active</span>
                                        {% elif asset.status == 'Inactive' %}
                                            <span class="badge bg-warning">Inactive</span>
                                        {% elif asset.status == 'Maintenance' %}
                                            <span class="badge bg-info">Maintenance</span>
                                        {% elif asset.status == 'Retired' %}
                                            <span class="badge bg-danger">Retired</span>
                                        {% else %}
                                            <span class="badge bg-secondary">{{ asset.status }}</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-sm table-borderless">
                                <tr>
                                    <th width="40%">Asset Type:</th>
                                    <td>
                                        {% if asset_type %}
                                            <span class="badge bg-info">{{ asset_type.name }}</span>
                                        {% else %}
                                            <span class="text-muted">No Asset Type</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <th>Make/Model:</th>
                                    <td>
                                        {% if make_model %}
                                            <strong>{{ make_model.make }} {{ make_model.model }}</strong>
                                            {% if make_model.year %}
                                                <br><small class="text-muted">{{ make_model.year }}</small>
                                            {% endif %}
                                        {% else %}
                                            <span class="text-muted">No Make/Model</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <th>Location:</th>
                                    <td>
                                        {% if location %}
                                            <span class="badge bg-secondary">{{ location.name }}</span>
                                        {% else %}
                                            <span class="text-muted">No Location</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <th>Created:</th>
                                    <td>
                                        <small class="text-muted">
                                            {{ asset.created_at.strftime('%Y-%m-%d %H:%M:%S') if asset.created_at else 'N/A' }}
                                        </small>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Meters Information -->
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="bi bi-speedometer2"></i> Meter Readings
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="text-center">
                                <h6>Meter 1</h6>
                                {% if asset.meter1 %}
                                    <span class="badge bg-primary fs-6">{{ "%.1f"|format(asset.meter1) }}</span>
                                {% else %}
                                    <span class="text-muted">No reading</span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <h6>Meter 2</h6>
                                {% if asset.meter2 %}
                                    <span class="badge bg-primary fs-6">{{ "%.1f"|format(asset.meter2) }}</span>
                                {% else %}
                                    <span class="text-muted">No reading</span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <h6>Meter 3</h6>
                                {% if asset.meter3 %}
                                    <span class="badge bg-primary fs-6">{{ "%.1f"|format(asset.meter3) }}</span>
                                {% else %}
                                    <span class="text-muted">No reading</span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <h6>Meter 4</h6>
                                {% if asset.meter4 %}
                                    <span class="badge bg-primary fs-6">{{ "%.1f"|format(asset.meter4) }}</span>
                                {% else %}
                                    <span class="text-muted">No reading</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Events -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">
                        <i class="bi bi-calendar-event"></i> Recent Events
                    </h6>
                    <a href="{{ url_for('events.list', asset_id=asset.id) }}" class="btn btn-sm btn-outline-primary">
                        View All Events
                    </a>
                </div>
                <div class="card-body">
                    {% if events %}
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Date/Time</th>
                                    <th>Event Type</th>
                                    <th>Description</th>
                                    <th>User</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for event in events %}
                                <tr>
                                    <td>
                                        <small class="text-muted">
                                            {{ event.timestamp.strftime('%Y-%m-%d %H:%M:%S') if event.timestamp else 'N/A' }}
                                        </small>
                                    </td>
                                    <td>
                                        <span class="badge bg-secondary">{{ event.event_type }}</span>
                                    </td>
                                    <td>{{ event.description }}</td>
                                    <td>
                                        <small class="text-muted">
                                            {{ event.user.username if event.user else 'System' }}
                                        </small>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="text-center py-3">
                        <i class="bi bi-calendar-event text-muted"></i>
                        <p class="text-muted mt-2">No events found for this asset.</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-md-4">
            <!-- Quick Actions -->
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="bi bi-lightning"></i> Quick Actions
                    </h6>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('core_assets.detail', asset_id=asset.id) }}" class="btn btn-outline-primary btn-sm">
                            <i class="bi bi-eye"></i> View Details
                        </a>
                        <a href="{{ url_for('assets.all_details.all_details', asset_id=asset.id) }}" class="btn btn-outline-info btn-sm">
                            <i class="bi bi-table"></i> View All Details ({{ detail_count }})
                        </a>
                        <a href="{{ url_for('core_assets.edit', asset_id=asset.id) }}" class="btn btn-outline-secondary btn-sm">
                            <i class="bi bi-pencil"></i> Edit Asset
                        </a>
                        <a href="{{ url_for('events.list', asset_id=asset.id) }}" class="btn btn-outline-info btn-sm">
                            <i class="bi bi-calendar-event"></i> View All Events
                        </a>
                        {% if make_model %}
                        <a href="{{ url_for('make_models.detail', make_model_id=make_model.id) }}" class="btn btn-outline-secondary btn-sm">
                            <i class="bi bi-gear"></i> View Make/Model
                        </a>
                        {% endif %}
                        {% if location %}
                        <a href="{{ url_for('locations.detail', location_id=location.id) }}" class="btn btn-outline-secondary btn-sm">
                            <i class="bi bi-geo-alt"></i> View Location
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Asset Statistics -->
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="bi bi-graph-up"></i> Statistics
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-6">
                            <h6>Detail Records</h6>
                            <span class="badge bg-info fs-5">{{ detail_count }}</span>
                        </div>
                        <div class="col-6">
                            <h6>Events</h6>
                            <span class="badge bg-primary fs-5">{{ events|length }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Asset Tags -->
            {% if asset.tags %}
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="bi bi-tags"></i> Tags
                    </h6>
                </div>
                <div class="card-body">
                    {% for tag in asset.tags %}
                    <span class="badge bg-light text-dark me-1 mb-1">{{ tag }}</span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
{% else %}
    <div class="text-center py-4">
        <i class="bi bi-arrow-up text-muted"></i>
        <p class="text-muted mt-2">Click on any asset row above to view its details here</p>
    </div>
{% endif %}

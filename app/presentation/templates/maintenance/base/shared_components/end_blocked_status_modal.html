<!-- End Blocked Status Modal -->
<div class="modal fade" id="endBlockedStatusModal{{ blocker.id }}" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form method="POST" action="{{ url_for('maintenance.end_blocked_status', blocked_status_id=blocker.id) }}">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <div class="modal-header">
                    <h5 class="modal-title">End Blocked Status</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label"><strong>Status:</strong> {{ blocker.mission_capability_status or 'N/A' }}</label>
                    </div>
                    {% if blocker.reason %}
                    <div class="mb-3">
                        <label class="form-label"><strong>Reason:</strong> {{ blocker.reason }}</label>
                    </div>
                    {% endif %}
                    
                    <div class="mb-3">
                        <label for="blocked_status_start_date{{ blocker.id }}" class="form-label">Start Time <span class="text-danger">*</span></label>
                        <input type="datetime-local" 
                               class="form-control" 
                               id="blocked_status_start_date{{ blocker.id }}" 
                               name="blocked_status_start_date"
                               value="{% if blocker.start_date %}{{ blocker.start_date.strftime('%Y-%m-%dT%H:%M') }}{% endif %}"
                               required>
                        <small class="form-text text-muted">When did the blocker start?</small>
                    </div>
                    
                    <div class="mb-3">
                        <label for="blocked_status_end_date{{ blocker.id }}" class="form-label">End Time <span class="text-danger">*</span></label>
                        <input type="datetime-local" 
                               class="form-control" 
                               id="blocked_status_end_date{{ blocker.id }}" 
                               name="blocked_status_end_date"
                               required>
                        <small class="form-text text-muted">When did/will the blocker end?</small>
                    </div>
                    
                    <div class="mb-3">
                        <label for="blocked_status_billable_hours{{ blocker.id }}" class="form-label">Billable Hours Lost <span class="text-danger">*</span></label>
                        <input type="number" 
                               step="0.25" 
                               min="0" 
                               class="form-control" 
                               id="blocked_status_billable_hours{{ blocker.id }}" 
                               name="blocked_status_billable_hours"
                               value="{% if blocker.billable_hours is not none %}{{ blocker.billable_hours }}{% else %}0{% endif %}"
                               required>
                        <small class="form-text text-muted">Total billable hours lost due to this blocker (0 if none)</small>
                    </div>
                    
                    <div class="mb-3">
                        <label for="blocked_status_notes{{ blocker.id }}" class="form-label">Update Notes</label>
                        <textarea class="form-control" 
                                  id="blocked_status_notes{{ blocker.id }}" 
                                  name="blocked_status_notes" 
                                  rows="3"
                                  placeholder="Optional: Add or update notes about this blocker...">{{ blocker.notes or '' }}</textarea>
                    </div>
                    
                    <div class="mb-3">
                        <label for="blocked_comment{{ blocker.id }}" class="form-label">Event Comment</label>
                        <textarea class="form-control" 
                                  id="blocked_comment{{ blocker.id }}" 
                                  name="comment" 
                                  rows="3"
                                  placeholder="Optional: Add details to the event comment when ending this blocker..."></textarea>
                        <small class="form-text text-muted">This will be added to the event's comment log</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-success">End Blocked Status</button>
                </div>
            </form>
        </div>
    </div>
</div>
